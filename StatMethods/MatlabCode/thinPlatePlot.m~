x1 = (0:0.05:1)';
x2 = (0:0.05:1)';

nx1 = length(x1);
nx2 = length(x1);

knot = [0.2 0.3; 0 0;0.4 0.2];
thinPlate = zeros(nx1,nx2,size(knot,2));
hardy = zeros(nx1,nx2);


for i = 1:nx1
    for j = 1:nx2
        x = [x1(i) x2(j)]';
        u = norm(x-knot(k,:)');
        if u>0
            thinPlate(i,j,k) = log(u)*(u^2);
        end
        hardy(i,j) = sqrt(0.1^2 + u^2);
    end
end

[X Y] = meshgrid(x1,x2);

figure
%subplot(1,2,1)
surf(X,Y,thinPlate)
%subplot(1,2,2)
surf(X,Y,hardy)
